<div>
    <p>Dear @Model.Name</p>
    
    @if (Model.DaysUntilFinalActionDate == 0)
    {
        <p>This message is to inform you that application @Model.ApplicationReference has reached its final action date and is yet to be processed.</p>
    }
    else
    {
        var absoluteDays = Math.Abs(Model.DaysUntilFinalActionDate);
        var timescaleText = Model.DaysUntilFinalActionDate > 0
            ? $"is still in review and has {absoluteDays} days remaining until its final action date."
            : $"is still in review and has exceeded its final action date by {absoluteDays} days.";

        <p>This message is to inform you that application @Model.ApplicationReference @timescaleText.</p>
    }

    @if (Model.ExtensionLength is not null)
    {
        <p>As this application has not previously been extended, the final action date has been extended for @Model.ExtensionLength days.</p>
        <p>The final action date is now @Model.FinalActionDate.</p>
    }

    <p>You can view this application by following this link: </p>
    <p><a href="@Model.ViewApplicationURL">@Model.ViewApplicationURL</a></p>

    <p><strong>Yours sincerely</strong></p>
    <p><strong>Forestry Commission</strong><br /> <strong>231 Corstorphine Road, Edinburgh EH12 7AT</strong></p>
    <p><a href="mailto:plant.health@forestrycommission.gov.uk">plant.health@forestrycommission.gov.uk</a><a><br /> +44 (0)300 067 5155 (direct)<br /> +44 (0)300 067 5000 (switchboard)<br /> </a></p>
    <p><strong><a href="https://www.gov.uk/forestrycommission">www.gov.uk/forestrycommission</a></strong></p>
</div>